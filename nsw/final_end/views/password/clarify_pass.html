<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>꼬질봇 - 비밀번호 인증</title>
    <style>
      body,
        html {
            height: 100%;
            /* 전체 높이를 100%로 설정 */
            margin: 0;
            /* 기본 마진 제거 */
            display: flex;
            /* flexbox를 사용 */
            align-items: center;
            /* 세로 중앙 정렬 */
            justify-content: center;
            /* 가로 중앙 정렬 */
            background-color: #f8f9fa;
            /* 배경 색상 설정 */
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            /* 폰트 설정 */
        }

    .form {
        width: 340px;
        height: 400px;
        display: flex;
        flex-direction: column;
        border-radius: 15px;
        background-color: white;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        transition: .4s ease-in-out;
      }
      
      .form:hover {
        box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
        scale: 0.99;
      }
      
      .heading {
        position: relative;
        text-align: center;
        color: black;
        top: 3em;
        font-weight: bold;
      }
      
      .check {
        position: relative;
        align-self: center;
        top: 4em;
      }
      
      .input {
        position: relative;
        width: 2.1em;
        height: 2.5em;
        margin: 1em;
        border-radius: 5px;
        border: none;
        outline: none;
        background-color: rgb(235, 235, 235);
        box-shadow: inset 3px 3px 6px #d1d1d1,
                  inset -3px -3px 6px #ffffff;
        top: 6.5em;
        left: 1.5em;
        padding-left: 15px;
        transition: .4s ease-in-out;
      }
      
      .input:hover {
        box-shadow: inset 0px 0px 0px #d1d1d1,
                  inset 0px 0px 0px #ffffff;
        background-color: lightgrey;
      }
      
      .input:focus {
        box-shadow: inset 0px 0px 0px #d1d1d1,
                  inset 0px 0px 0px #ffffff;
        background-color: lightgrey;
      }
      
      .btn1 {
        position: relative;
        top: 8.5em;
        left: 1.8em;
        width: 22em;
        height: 3em;
        border-radius: 5px;
        border: none;
        outline: none;
        transition: .4s ease-in-out;
        box-shadow: 1px 1px 3px #b5b5b5,
                   -1px -1px 3px #ffffff;
      }
      
      .btn1:active {
        box-shadow: inset 3px 3px 6px #b5b5b5,
                  inset -3px -3px 6px #ffffff;
      }
      
      .btn2 {
        position: relative;
        top: 9.5em;
        left: 1.8em;
        width: 22em;
        height: 3em;
        border-radius: 5px;
        border: none;
        outline: none;
        transition: .4s ease-in-out;
        box-shadow: 1px 1px 3px #b5b5b5,
                   -1px -1px 3px #ffffff;
      }
      
      .btn2:active {
        box-shadow: inset 3px 3px 6px #b5b5b5,
                  inset -3px -3px 6px #ffffff;
      }</style>
</head>
<body>
    <form class="form">
        <p class="heading">Verify</p>
        <svg class="check" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="60px" height="60px" viewBox="0 0 60 60" xml:space="preserve">  <image id="image0" width="60" height="60" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAQAAACQ9RH5AAAABGdBTUEAALGPC/xhBQAAACBjSFJN
      AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZ
      cwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0NDzN/r+StAAACR0lEQVRYw+3Yy2sTURTH8W+bNgVf
      aGhFaxNiAoJou3FVEUQE1yL031BEROjCnf4PLlxILZSGYncuiiC48AEKxghaNGiliAojiBWZNnNd
      xDza3pl77jyCyPzO8ubcT85wmUkG0qT539In+MwgoxQoUqDAKDn2kSNLlp3AGi4uDt9xWOUTK3xg
      hVU2wsIZSkxwnHHGKZOxHKfBe6rUqFGlTkPaVmKGn6iYao1ZyhK2zJfY0FZ9ldBzsbMKxZwZjn/e
      5szGw6UsD5I0W6T+hBhjUjiF7bNInjz37Ruj3igGABjbtpIo3GIh30u4ww5wr3fwfJvNcFeznhBs
      YgXw70TYX2bY/ulkZhWfzfBbTdtrzjPFsvFI+T/L35jhp5q2owDs51VIVvHYDM9sa/LY8XdtKy1l
      FXfM8FVN2/X2ajctZxVXzPA5TZvHpfb6CFXxkerUWTOcY11LX9w0tc20inX2mmF4qG3upnNWrOKB
      hIXLPu3dF1x+kRWq6ysHpkjDl+7eQjatYoOCDIZF3006U0unVSxIWTgTsI3HNP3soSJkFaflMDwL
      3OoHrph9YsPCJJ5466DyOGUHY3Epg2rWloUxnMjsNw7aw3AhMjwVhgW4HYm9FZaFQZ/bp6QeMRQe
      hhHehWKXGY7CAuSpW7MfKUZlAUqWdJ3DcbAAB3guZl9yKC4WYLfmT4muFtgVJwvQx7T2t0mnXK6J
      XlGGyAQvfNkaJ5JBmxnipubJ5HKDbJJsM0eY38QucSx5tJWTVHBwqDDZOzRNmn87fwDoyM4J2hRz
      NgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMi0xM1QxMzoxNTo1MCswMDowMKC8JaoAAAAldEVY
      dGRhdGU6bW9kaWZ5ADIwMjMtMDItMTNUMTM6MTU6NTArMDA6MDDR4Z0WAAAAKHRFWHRkYXRlOnRp
      bWVzdGFtcAAyMDIzLTAyLTEzVDEzOjE1OjUxKzAwOjAwIIO3fQAAAABJRU5ErkJggg=="></image>
      </svg>
        <div class="box">
        <input class="input" type="password" maxlength="1" id="code1">
        <input class="input" type="password" maxlength="1" id="code2"> 
        <input class="input" type="password" maxlength="1" id="code3">
        <input class="input" type="password" maxlength="1" id="code4">
        </div>
        <button type="button" class="btn1" onclick="submitCode()">인증</button>
        <button class="btn2" type="button" onclick="history.go(-1)">돌아가기</button>
      </form>
      <script>
        function submitCode() {
            var code1 = $('#code1').val().trim();
            var code2 = $('#code2').val().trim();
            var code3 = $('#code3').val().trim();
            var code4 = $('#code4').val().trim();
            if (code1.length === 0 || code2.length === 0 || code3.length === 0 || code4.length === 0) {
                alert('모든 코드를 입력해주세요.');
                return;
            }
            var code = code1 + code2 + code3 + code4;
            if (!/^\d{4}$/.test(code)) {
                alert('인증 코드는 4자리 숫자여야 합니다.');
                return;
            }
            $.ajax({
                url: '/process/verify_code',
                type: 'POST',
                data: { code: code },
                success: function (data) {
                    alert(data.message);
                    if(data.success) {
                        window.location.href = '/password_reset'; // 인증 성공 시 비밀번호 변경 페이지로 이동
                    }
                },
                error: function (xhr, status, error) {
                    console.error('Error:', error);
                }
            });
        }
    </script>
</body>
</html>